# ‚úçÔ∏è Writer Classification Project (BERT vs LSTM)

![Python](https://img.shields.io/badge/Python-3.10-blue?logo=python)
![PyTorch](https://img.shields.io/badge/Framework-PyTorch-red?logo=pytorch)
![Model](https://img.shields.io/badge/Model-RuBERT-green?logo=transformers)
![Accuracy](https://img.shields.io/badge/Val_Accuracy-78%25-brightgreen)

---

## üß† 1. –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–æ –∞–≤—Ç–æ—Ä—Å—Ç–≤—É, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π:
- –ü—Ä–æ—Å—Ç–∞—è LSTM-—Å–µ—Ç—å
- –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä `RuBERT` (DeepPavlov)

–ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –æ—Ç–ª–∏—á–∞—Ç—å —Å—Ç–∏–ª–∏ 6 –∞–≤—Ç–æ—Ä–æ–≤:
**Bradbury, Bulgakov, Fry, Genri, Simak, Strugatskie**.

---

## ‚öôÔ∏è 2. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞:**
- –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ç–æ—á–∫–∏, –ø—Ä–æ–±–µ–ª—ã)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- `transformers`, `torch`, `sklearn`, `seaborn`, `matplotlib`

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (BERT):**
- `BertModel`
- `Dropout(p=0.3)`
- `Linear(768 ‚Üí 6)`

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (LSTM):**
- `Embedding ‚Üí BiLSTM ‚Üí Dropout ‚Üí Linear`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å Embedding –∏ —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º —Ä–∞–∑–º–µ—Ä–æ–º 128

---

## üöÄ 3. –û–±—É—á–µ–Ω–∏–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã



### üìò BERT-–º–æ–¥–µ–ª—å

| Epoch | Train Acc | Val Acc |
|-------|-----------|---------|
| 1     | 0.50      | 0.66    |
| 2     | 0.77      | 0.75    |
| 3     | 0.90      | 0.77 ‚úÖ |
| 4     | 0.95      | 0.76    |
| 5     | 0.97      | 0.77    |

- –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ **3-–π —ç–ø–æ—Ö–µ**
- –ü–æ—Å–ª–µ –Ω–µ—ë ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

### üìô LSTM-–º–æ–¥–µ–ª—å

| Epoch | Train Acc | Val Acc |
|-------|-----------|---------|
| 1     | 0.20      | 0.26    |
| 5     | 0.76      | 0.49    |
| 10    | 0.98      | 0.56    |
| 20    | 1.00      | 0.57    |
| 50    | 1.00      | 0.49    |

- –°–∏–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ 10-–π —ç–ø–æ—Ö–∏
- –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–µ —Ä–∞—Å—Ç—ë—Ç –ø–æ—Å–ª–µ –ø–∏–∫–∞

---

## üìä 4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (BERT)

**Macro F1:** `0.78`  
**Accuracy:** `0.78`

**–õ—É—á—à–∏–µ F1:**
- Bulgakov ‚Äî `0.86`
- Genri ‚Äî `0.80`
- Fry ‚Äî `0.78`

**Confusion Matrix** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ö–æ—Ä–æ—à–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º. –û—à–∏–±–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–µ–∂–¥—É –±–ª–∏–∑–∫–∏–º–∏ –ø–æ —Å—Ç–∏–ª—é –∞–≤—Ç–æ—Ä–∞–º–∏.

---

## üìä 5. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (LSTM)

**Macro F1:** `0.35`  
**Accuracy:** `0.37`

**–ù–∞–∏—Ö—É–¥—à–∏–µ F1:**
- Genri ‚Äî `0.13`
- Bulgakov ‚Äî `0.39`

LSTM –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∏–ª—å–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ: –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç `Train Acc ‚âà 1.00`, –∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ‚Äî `~0.37`.

---

## ‚öñÔ∏è 6. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | Accuracy | Macro F1 | –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è | –í—ã–≤–æ–¥ |
|--------|----------|----------|----------------|--------|
| LSTM   | 0.37     | 0.35     | ~10 —Å–µ–∫—É–Ω–¥     | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
| BERT   | 0.78     | 0.78     | ~2 –º–∏–Ω—É—Ç—ã      | –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ‚úÖ

### –ü—Ä–∏–º–µ—Ä—ã `classification_report`:

```
LSTM:
Bulgakov ‚Äî F1: 0.39
Genri    ‚Äî F1: 0.13
Fry      ‚Äî F1: 0.58

BERT:
Bulgakov ‚Äî F1: 0.86
Genri    ‚Äî F1: 0.80
Fry      ‚Äî F1: 0.78
```

---

## üßæ 7. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- üìì [hw1_LSTM.ipynb](hw1_LSTM.ipynb) ‚Äî –∫–æ–¥ –º–æ–¥–µ–ª–∏ –Ω–∞ LSTM
- üìÑ [hw1_LSTM.md](hw1_LSTM.md) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞ LSTM
- üìì [hw1_BERT.ipynb](hw1_BERT.ipynb) ‚Äî –∫–æ–¥ –º–æ–¥–µ–ª–∏ –Ω–∞ BERT
- üìÑ [hw1_BERT.md](hw1_BERT.md) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞ BERT
- üìÅ [submission_LSTM.csv](submission_LSTM.csv) ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç LSTM
- üìÅ [submission_BERT.csv](submission_BERT.csv) ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç BERT

---

## üìå 8. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã —è–≤–Ω–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–µ—Ç–∏ –≤ –∑–∞–¥–∞—á–µ —Å—Ç–∏–ª–æ–º–µ—Ç—Ä–∏–∏
- –î–∞–∂–µ –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö BERT —Å–ø–æ—Å–æ–±–µ–Ω –≤—ã—É—á–∏—Ç—å –æ—Ç–ª–∏—á–∏—è –º–µ–∂–¥—É —Å—Ç–∏–ª—è–º–∏
- –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–∂–Ω–æ:
  - –í–≤–µ—Å—Ç–∏ `early stopping`
  - –£–≤–µ–ª–∏—á–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –≤—ã–±–æ—Ä–∫—É
  - –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Å–ª–æ–∏ BERT

---

## üßæ –§–∏–Ω–∞–ª

–ú–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ **RuBERT** –¥–æ—Å—Ç–∏–≥–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ **~78%** –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö F1-–º–µ—Ç—Ä–∏–∫ –ø–æ –∫–∞–∂–¥–æ–º—É –∞–≤—Ç–æ—Ä—É. –û–Ω–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∞–≤—Ç–æ—Ä–æ–≤ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Å—Ç–∏–ª–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.



